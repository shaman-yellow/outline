---
---

```{r include = F, eval = F}
deparse_mail()
info <- items(belong = odate(12), coef = NA)

order_publish()
idname <- order_packaging()
```

```{r include = F}
#| setup
if (!requireNamespace("utils.tool"))
  devtools::load_all("~/utils.tool/")
autor_preset()
## the package are available at <https://github.com/shaman-yellow/utils.tool>
## if you want to run codes of this Rmarkdown,
## please install the package `utils.tool` and other related packages (run
## install.R)
options(savedir = list(figs = "Figure+Table", tabs = "Figure+Table"))
```

```{r eval = T, echo = F, results = "asis"}
set_cover(info$title)
```

```{r eval = T, echo = F, results = "asis"}
set_index()
```

# 摘要 {#abstract}

```{r}
dic(di("差异表达基因", "Differential Expressed Genes", "DEGs"),
  di("肺血管病理性重塑"))

# DEGs: Differential Expressed Genes 差异表达基因
# PROPV: Pathological remodeling of pulmonary vessels 肺血管病理性重塑
```

脓毒症肺损伤+血管重塑+基因+糖酵解 (DisGeNet, genecards, NCBI, PharmGKB)

- 糖酵解与肺血管病理性重塑（如果比较少，放宽到血管重塑remodeling）相关的基因集
- 对基因集做功能通路富集分析
- 在这些基因集中找到kif2c（如果包含可能名次比较靠后了），及kif2c相关的基因，做PPI网络图
- 目标靶基因是MYC，用分子对接模拟KIF2C与MYC蛋白互作
- 其他，看有能满足思路的花里胡哨的图都可以放上来

客户需求：希望把生信的可视化结果弄得漂亮一点，目前PPI图虽然可以看出kif2c和myc的关系，但是过于单调。有没有可能再加分子对接或者两者在糖酵解代谢途径中的富集等等（不知道kegg和go分析能否用上）。辛苦增加部分生信分析的图片和结果（就是想视觉上再丰富一点，图做得好看一点多一点）

# 前言 {#introduction}

# 材料和方法 {#methods}

## 材料

```{r eval = T, echo = F, results = "asis"}
auto_material()
```

## 方法

```{r eval = T, echo = F, results = "asis"}
auto_method()
```

# 分析结果 {#results}

# 结论 {#dis}

# 附：分析流程 {#workflow}

```{r}

```

```{r}
# DisGeNet
x <- ftibble("~/outline/lixiao/database/DisGeNet_disease_associations.tsv.gz")

y <- RCurl::getURL('https://www.disgenet.org/browser/0/1/0/C0000768/0/2000/source__ALL/_b./#')
tt <- as_tibble(get_table.html(y)[[1]])

fun_format <- function(x) {
  x <- dplyr::select(x, type = 1, value = 2)
  x <- dplyr::mutate(x, type = gs(type, "^(.+?):.*", "\\1"),
    type = ifelse(grpl(type, "^[A-Z]"), type, "UniProt"),
    type = make.names(type))
  rows <- nrow(x) / 3
  x <- split_lapply_rbind(x, rep(1:rows, each = 3),
    function(x) {
      tidyr::spread(x, type, value)
    })
  x
}
fun_format(tt)
```
